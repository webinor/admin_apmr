var protocol="https:"===location.protocol?"https://":"http://",host=location.host,alert_success_node="#overview .alert-success",ajaxRequest={};function sendAjaxRequest(e){$.ajax(e)}function FormatCurrency(e,t){return e.toString().match(/^-?\d+(?:\.\d{0,3})?/)[0]}function convertCurrency(e,t){var n=$(`${e} .${t}`).value();$(`#${e} .amount`).keyup((function(t){var a=$(this).val();$(`#${e} .end-amount`).val(FormatCurrency(a*n))})),$(`#${e} .end-amount`).keyup((function(t){var a=$(this).val();$(`#${e} .amount`).val(FormatCurrency(a/n))}))}function constructAjaxRequest(e,t={},n,a,o,s="POST",i=!0,r=!0,c="json"){let l={type:s,url:`${protocol}${host}${e}`,data:t,headers:{"X-CSRF-Token":$('meta[name="csrf-token"]').attr("content")},beforeSend:function(e){e.setRequestHeader("Authorization",`Bearer ${window.localStorage.getItem("token")}`)},dataType:c,success:function(e,t,a){n(e,t,a)},error:function(e){a(e)},complete:function(e,t){o(e,t)}};return r||i||(l.contentType=!1,l.processData=!1),l}$(".currency").change((function(e){e.preventDefault();let t=$(this).closest("form").attr("id");if(""!=$(this).val()){var n=$("option:selected",this).data("currency");$(`#${t} .amount`).attr("readonly",!1),$(`#${t} .end-currency`).text(n)}else $(`#${t} .amount`).attr("readonly",!0),$(`#${t} .end-currency`).text("")})),$(".amount").keyup((function(e){var t=$(this).val(),n=$(this).closest("form").attr("id"),a=$("option:selected",`#${n} #currency`).data("rate");$(`#${n} .end-amount`).val(FormatCurrency(t*a))})),$(".end-amount").keyup((function(e){var t=$(this).val();current_form=$(this).closest("form").attr("id");var n=$("option:selected",`#${current_form} #currency`).data("rate");$(`#${current_form} .amount`).val(FormatCurrency(t/n))})),$(".instances_lines").on("click",".delete",(function(e){let t=$(this).closest("table"),n=$(this).closest("tr"),a=$(this).siblings("input").val(),o=$(`#${t.attr("id")}`).data("type"),s=$(`#${t.attr("id")} `).data("url");deleteInstance(a,n,s,o),e.preventDefault()}));const deleteInstance=(e,t,n,a)=>{let o=t.attr("id");o&&($(`#${o} .print`).addClass("d-none"),$(`#${o} .edit`).addClass("d-none"),$(`#${o} .show`).addClass("d-none"),$(`#${o} .delete`).addClass("d-none"),$(`#${o} .loader`).removeClass("d-none")),$(`.${a}_${e}`).toggleClass("d-none");let s={},i=`/api/${n}/${e}`;s.instance=e,sendAjaxRequest(constructAjaxRequest(i,s,(function(n,o,s){n.status&&(t.remove(),$(`.${a}_${e}`).toggleClass("d-none"))}),(function(e){}),(function(e,t){o&&($(`#${o} .print`).removeClass("d-none"),$(`#${o} .edit`).removeClass("d-none"),$(`#${o} .show`).removeClass("d-none"),$(`#${o} .delete`).removeClass("d-none"),$(`#${o} .loader`).addClass("d-none"))}),"DELETE"))};function xhrError(e){$.each(e.responseJSON.errors,(function(e,t){$(`#${e} `).siblings(".invalid-feedback").text(t[0]),$(`#${e} `).addClass("is-invalid")}))}function responseError(e){$.each(e.errors,(function(e,t){$(`#${e} `).siblings(".invalid-feedback").text(t[0]),$(`#${e} `).addClass("is-invalid")}))}function getInputValues(e="form",t={},n="form-control",a=!0,o=[],s=[]){let i=$(`#${e}  .${n}`);return $.map(i,(function(n,o){n.id&&n.value&&s.indexOf(n.id)<0&&($(`#${e} #${n.id}`).removeClass("is-invalid"),a?t[n.id]=n.value:t.append(n.id,n.value))})),$.map(o,(function(n,o){console.log(n);let s=$(`#${e}  .${n}`).val();console.log(s),s&&(a?t[n]=s:t.append(n,s))})),t}function getFileValues(e="form",t,n="file",a="files[]",o=!0){$(`#${e}  .${n}`);if($(`#${e} .${n}`)){var s=$(`#${e} .${n}`)[0].files,i=s.length;if(i>0)for(var r=0;r<i;r++)s[r]&&t.append(a,s[r]);return t}}$(".modal-footer #validate").click((function(e){let t=getInputValues("form_modal"),n=$("#modal_url").val();sendAjaxRequest(ajaxRequest=constructAjaxRequest(n,t,(function(e,t,n){e.status?location.reload():$.each(e.errors,(function(e,t){}))}),(function(e){$.each(e.responseJSON.errors,(function(e,t){}))}),(function(e,t){})))}));const addRow=(e,t,n,a="create",o=!0,s=!0,i=!1)=>{let r="",c=[];switch(e){case"observation":c=[n.observation.content];break;case"payment":let e=n;c=[e.amount,e.payment_method.name,"",e.paid_at,"",`${e.user.employee.first_name} ${e.user.employee.last_name}`];break;case"related_resourc":c=[e.amount,e.payment_method.name,`${e.user.employee.first_name} ${e.user.employee.last_name}`,e.paid_at];break;case"file":c=[n.name,n.type,new Date(n.created_at)];break;case"area_duration":c=[`[${n.min}  ${n.max}]`,n.duration.name,new Date(n.created_at)];break;case"order_line":let t=n;c=[t.title,null!=t.quantity?t.quantity:"",null!=t.price?`${t.price}`:"",null!=t.quantity&&null!=t.price?parseInt(t.quantity)*parseFloat(t.price):""]}if($.each(c,(function(e,t){r+=null!=t?`<td>${t}</td>`:"<td></td>"})),""!=r){let e=`<tr class = "line tr_${n.code}">${r}\n         <td> <form id="form_detail_${n.code}">\n          ${o?`<a target="_blank" class="supplier_${n.code}  me-3 print" href="${protocol}${host}/storage/ad_images/${n.path}" ><i class="menu-icon mdi mdi-eye"></i></a>`:""}\n          ${i?`<a id="edit_${n.code}"  class="me-3 edit" ><i class="menu-icon mdi mdi-table-edit"></i></a>`:""}\n          ${s?`<a id="delete_${n.code}"  class=" delete" ><i class="menu-icon mdi mdi-close-circle"></i></a>\n          <input id="input_${n.code}" type="hidden" value="${n.code}"> \n        <div class="loader d-none d-flex justify-content-center mt-3">\n                          <div class="inner-loading dot-flashing"></div>\n                      </div>`:""}\n          </form> \n        </td>\n        </tr>`;"update"==a?($(`#${t} #tr_${n.code}`).html(e),$("#update_payment_button").addClass("d-none"),$("#save_payment_button").removeClass("d-none")):$(`#${t} tr:last`).after(e)}},handleXhrError=e=>{if(422===e.status)console.log(e.responseJSON.errors),$.each(e.responseJSON.errors,(function(e,t){$(`#${e}`).siblings(".invalid-feedback").text(t[0]),$(`#${e}`).addClass("is-invalid")}))};$((function(){$(".lazy").Lazy({effect:"fadeIn",effectTime:1e3,onError:function(e){},beforeLoad:function(e){},afterLoad:function(e){},onFinishedAll:function(){this.config("autoDestroy")||this.destroy()}})})),$(document).ready((function(){document.createElement("img").src="https://s3-us-west-2.amazonaws.com/s.cdpn.io/245657/timeline1.png",$("#searchfield").focus((function(){"Search contacts..."==$(this).val()&&$(this).val("")})),$("#searchfield").focusout((function(){""==$(this).val()&&$(this).val("Search contacts...")})),$("#sendmessage input").focus((function(){"Send message..."==$(this).val()&&$(this).val("")})),$("#sendmessage input").focusout((function(){""==$(this).val()&&$(this).val("Send message...")})),$(".friend").each((function(){$(this).click((function(){var e=$(this).offset(),t=$(this).parent().parent().offset(),n=e.top-t.top,a=$(this).find("img").eq(0).clone(),o=n+12+"px";$(a).css({top:o}).addClass("floatingImg").appendTo("#chatbox"),setTimeout((function(){$("#profile p").addClass("animate"),$("#profile").addClass("animate")}),100),setTimeout((function(){$("#chat-messages").addClass("animate"),$(".cx, .cy").addClass("s1"),setTimeout((function(){$(".cx, .cy").addClass("s2")}),100),setTimeout((function(){$(".cx, .cy").addClass("s3")}),200)}),150),$(".floatingImg").animate({width:"68px",left:"108px",top:"20px"},200);var s=$(this).find("p strong").html(),i=$(this).find("p span").html();$("#profile p").html(s),$("#profile span").html(i),$(".message").not(".right").find("img").attr("src",$(a).attr("src")),$("#friendslist").fadeOut(),$("#chatview").fadeIn(),$("#close").unbind("click").click((function(){$("#chat-messages, #profile, #profile p").removeClass("animate"),$(".cx, .cy").removeClass("s1 s2 s3"),$(".floatingImg").animate({width:"40px",top:o,left:"12px"},200,(function(){$(".floatingImg").remove()})),setTimeout((function(){$("#chatview").fadeOut(),$("#friendslist").fadeIn()}),50)}))}))}))}));